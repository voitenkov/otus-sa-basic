# 5. Предметная область и словарь данных

# 5.1 Список требований для MVP

По согласованию с финансовым директором ООО “Автокомпания” были выбраны следующие требования для реализации в рамках MVP:

| № п.п. | Пользовательские требования | Функциональные и нефункциональные требования |
| --- | --- | --- |
| 1 | Модуль учета заказов на склад в системе (URQ1). | 1. Создание нового заказа на запчасти (FRQ1.1) 2. Вывод списка заказов на запчасти (FRQ1.2) 3. Вывод заказа на запчасти на просмотр (FRQ1.3) 4. Сохранение измененного заказа на запчасти (FRQ1.4) 5. Удаление заказа на запчасти (FRQ1.5) |
| 2 | Модуль учета внутренних перемещений в системе (URQ2) | 1. Создание новой накладной на перемещение (FRQ2.1) 2. Вывод списка накладных на перемещение (FRQ2.2) 3. Вывод накладной на перемещение на просмотр (FRQ2.3) 4. Вывод накладной на перемещение на редактирование (FRQ2.4). 5. Сохранение измененной накладной на перемещение (FRQ2.5) 6. Удаление накладной на перемещение (FRQ2.6) |
| 3 | Модуль настройки прав доступа к документам в системе (URQ8) | 1. Создание пользователя (FRQ8.1). 2. Удаление пользователя (FRQ8.2). 3. Редактирование списка пользователей и прав доступа (FRQ8.3). 4. Редактирование списка прав доступа пользователя (FRQ8.4). 5. Редактирование списка пользователей и прав доступа для документа (FRQ8.5). 6. Редактирование справочника сотрудников (FRQ8.6) 7. Редактирование справочника должностей (FRQ8.7) |
| 4 | Модуль учета квалификации специалистов и сложности работ (URQ10). | 1. Редактирование справочника квалификации (FRQ10.1). 2. Редактирование справочника сложности работ (FRQ10.2). 3. Редактирование справочника механиков (FRQ10.3) |
| 5 | Модуль учета наряд-заказов в системе (URQ11). | 1. Создание нового наряд-заказа (FRQ11.1). 2. Вывод списка наряд-заказов (FRQ11.2). 3. Редактирование наряд-заказа (FRQ11.3). 4. Удаление наряд-заказа (FRQ11.4). 5. Редактирование справочника клиентов (FRQ11.5) 6. Редактирование справочника автомобилей клиентов (FRQ11.6) 7. Редактирование справочника СТО (FRQ11.7) |
| 6 | Модуль справочника номенклатуры автозапчастей (URQ12) | 1. Редактирование справочника номенклатуры запчастей (FRQ12.1). |
| 7 | Программа может работать с документами в многопользовательском режиме (URQ14) | 1. Программа может работать с документами в многопользовательском режиме (нефункциональное требование) (NRQ14.1) |
| 8 | Модуль отчетов по выполненным работам (URQ15) | 1. Вывод отчета по выполненным работам (FRQ15.1) |
| 9 | Модуль расчета оплаты за сдельную работу (URQ16) | 1. Вывод отчета по оплате за сдельную работу (FRQ16.1) |
| 10 | Модуль получения остатков товаров на складах (URQ17). | 1. Вывод остатков товаров (URQ17.1). 2. Редактирование справочника складов (URQ17.2) |

# 5.2 Словарь данных для сущностей предметной области (URQ8, URQ10-URQ12, URQ17)

Словарь данных формируем сразу в формате схемы конкретной базы данных, чтобы потом не переделывать. Возьму PostgeSQL, как наиболее вероятный вариант СУБД в текущих реалиях:

| Пользовательское требование | Сущность | Блоки/ Атрибуты | Тип данных | Длина, байт | Обязательность | Справочники/комментарии | Связи |
| --- | --- | --- | --- | --- | --- | --- | --- |
| URQ11 | Наряд-заказ | task_order_id | int4 | 4 | да |  | один ко многим с работы наряд-заказа, один ко многим с запчасти наряд-заказа |
| URQ11 | Наряд-заказ | task_order_no | varchar | 15 | да |  |  |
| URQ11 | Наряд-заказ | task_order_date | date | 4 | да |  |  |
| URQ11 | Наряд-заказ | service_station_id | int4 | 4 | да | Справочник СТО | многие ко одному со справочником СТО |
| URQ11 | Наряд-заказ | service_station_name | varchar | 40 | да | Справочник СТО |  |
| URQ11 | Наряд-заказ | employee_id | int4 | 4 | да | Справочник сотрудников | многие ко одному со справочником сотрудников |
| URQ11 | Наряд-заказ | employee_full_name | varchar | 80 | да | Справочник сотрудников (составное поле) |  |
| URQ11 | Наряд-заказ | vehicle_id | int4 | 4 | да | Автомобили клиентов | многие ко одному с Автомобилями клиентов |
| URQ11 | Наряд-заказ | vehicle_VIN | char | 17 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | engine_no | varchar | 17 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | vehicle_model | varchar | 20 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | vehicle_year | date | 4 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | vehicle_reg_no | varchar | 15 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | vehicle_mileage | int4 | 4 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | vehicle_warranty_start | date | 4 | нет | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | customer_id | int4 | 4 | да | Автомобили клиентов |  |
| URQ11 | Наряд-заказ | customer_fulll_name | varchar | 62 | да | Справочник клиентов (составное поле) |  |
| URQ11 | Наряд-заказ | customer_address | varchar | 40 | да | Справочник клиентов |  |
| URQ11 | Наряд-заказ | customer_passport_no | varchar | 40 | да | Справочник клиентов |  |
| URQ11 | Наряд-заказ | customer_contacts | varchar | 40 | да | Справочник клиентов |  |
| URQ11 | Наряд-заказ | works_hours | numeric(3,1) | 4 | да | Агрегация SUM(work_hours * work_qty) Работ наряд-заказа |  |
| URQ11 | Наряд-заказ | works_amount | money | 8 | да | Агрегация SUM(work_amount) Работы наряд-заказа |  |
| URQ11 | Наряд-заказ | parts_amount | money | 8 | да | Агрегация SUM(part_amount) Запчасти наряд-заказа |  |
| URQ11 | Работы наряд-заказа | task_order_id | int4 | 4 | да |  | многие к одному с наряд-заказом |
| URQ11 | Работы наряд-заказа | work_id | int4 | 4 | да | Справочник работ | многие к одному со справочником работ |
| URQ11 | Работы наряд-заказа | work_name | varchar | 40 | да | Справочник работ |  |
| URQ11 | Работы наряд-заказа | work_hours | numeric(2,1) | 3 | да | Нормо-час, Справочник работ |  |
| URQ11 | Работы наряд-заказа | work_qty | int4 | 4 | да |  |  |
| URQ11 | Работы наряд-заказа | work_amount | money | 8 | да |  |  |
| URQ11 | Запчасти наряд-заказа | task_order_id | int4 | 4 | да |  | многие к одному с наряд-заказом |
| URQ11 | Запчасти наряд-заказа | part_id | int4 | 4 | да | Справочник запчастей | многие ко одному со справочником запчастей |
| URQ11 | Запчасти наряд-заказа | part_name | varchar | 20 | да | Справочник запчастей |  |
| URQ11 | Запчасти наряд-заказа | part_no | varchar | 20 | да | Справочник запчастей |  |
| URQ11 | Запчасти наряд-заказа | part_qty | int4 | 4 | да |  |  |
| URQ11 | Запчасти наряд-заказа | part_amount | money | 8 | да |  |  |
| URQ10 | Справочник работ | work_id | int4 | 4 | да |  |  |
| URQ10 | Справочник работ | work_name | varchar | 40 | да |  |  |
| URQ10 | Справочник работ | work_hours | numeric(3,1) | 4 | да |  |  |
| URQ10 | Справочник работ | work_cost | money | 8 | да |  |  |
| URQ10 | Справочник работ | skill_id | int4 | 4 | да |  | многие ко одному со справочником квалификаций |
| URQ11 | Автомобили клиентов | vehicle_id | int4 | 4 | да |  |  |
| URQ11 | Автомобили клиентов | customer_id | int4 | 4 | да | Справочник клиентов | многие ко одному со справочником клиентов |
| URQ11 | Автомобили клиентов | vehicle_VIN | char | 17 | да |  |  |
| URQ11 | Автомобили клиентов | vehicle_engine_no | varchar | 17 | да |  |  |
| URQ11 | Автомобили клиентов | vehicle_model | varchar | 20 | да |  |  |
| URQ11 | Автомобили клиентов | vehicle_year | date | 4 | да |  |  |
| URQ11 | Автомобили клиентов | vehicle_reg_no | varchar | 15 | да |  |  |
| URQ11 | Автомобили клиентов | vehicle_mileage | int4 | 4 | да |  |  |
| URQ11 | Автомобили клиентов | vehicle_warranty_start | date | 4 | нет |  |  |
| URQ11 | Справочник клиентов | customer_id | int4 | 4 | да |  |  |
| URQ11 | Справочник клиентов | customer_surname | varchar | 20 | да |  |  |
| URQ11 | Справочник клиентов | customer_name | varchar | 20 | да |  |  |
| URQ11 | Справочник клиентов | customer_patronymic | varchar | 20 | нет |  |  |
| URQ11 | Справочник клиентов | customer_address | varchar | 40 | да |  |  |
| URQ11 | Справочник клиентов | customer_passport_no | varchar | 40 | да |  |  |
| URQ11 | Справочник клиентов | customer_contacts | varchar | 40 | да |  |  |
| URQ8 | Справочник сотрудников | employee_id | int4 | 4 | да |  |  |
| URQ8 | Справочник сотрудников | employee_surname | varchar | 20 | да |  |  |
| URQ8 | Справочник сотрудников | employee_name | varchar | 20 | да |  |  |
| URQ8 | Справочник сотрудников | employee_patronymic | varchar | 20 | нет |  |  |
| URQ8 | Справочник сотрудников | position_id | int4 | 4 | да | Справочник должностей | многие ко одному со справочником должностей |
| URQ10 | Справочник механиков | mechanic_id | int4 | 4 | да |  |  |
| URQ10 | Справочник механиков | employee_id | int4 | 4 | да | Справочник сотрудников | один ко одному со справочником сотрудников |
| URQ10 | Справочник механиков | skill_id | int4 | 4 | да | Справочник квалификаций | многие ко одному со справочником квалификаций |
| URQ10 | Справочник квалификаций | skill_id | int4 | 4 | да |  |  |
| URQ10 | Справочник квалификаций | skill_name | varchar | 20 | да |  |  |
| URQ12 | Справочник запчастей | part_id | int4 | 4 | да |  |  |
| URQ12 | Справочник запчастей | part_no | varchar | 20 | да |  |  |
| URQ12 | Справочник запчастей | part_name | varchar | 20 | да |  |  |
| URQ12 | Справочник запчастей | part_price | money | 8 | да |  |  |
| URQ11 | Справочник СТО | service_station_id | int4 | 4 | да |  |  |
| URQ11 | Справочник СТО | service_station_name | varchar | 20 | да |  |  |
| URQ11 | Справочник СТО | service_station_address | varchar | 40 | да |  |  |
| URQ8 | Справочник должностей | position_id | int4 | 4 | да |  |  |
| URQ8 | Справочник должностей | position_name | varchar | 20 | да |  |  |
| URQ17 | Остатки запчастей | part_id | int4 | 4 | да | Справочник запчастей | многие к одному со справочником запчастей |
| URQ17 | Остатки запчастей | warehouse_id | int4 | 4 | да | Справочник складов | многие к одному со справочником складов |
| URQ17 | Остатки запчастей | qty_available | int4 | 4 | да |  |  |
| URQ17 | Остатки запчастей | qty_reserved | int4 | 4 | да |  |  |
| URQ17 | Справочник складов | warehouse_id | int4 | 4 | да |  |  |
| URQ17 | Справочник складов | warehouse_name | varchar | 20 | да |  |  |
| URQ17 | Справочник складов | warehouse_address | varchar | 40 | да |  |  |

# 5.3 ER-диаграмма для сущностей предметной области (URQ8, URQ10-URQ12, URQ17)

ER-диаграмма сгенерирована из UML-описания на основе словаря данных, исходный код размещен в репозитории [https://github.com/voitenkov/otus-sa-basic/blob/main/diagrams/src/05_ER_diagram.wsd](https://github.com/voitenkov/otus-sa-basic/blob/main/diagrams/src/05_ER_diagram.wsd) Использован Microsoft Visual Studio Code + PlantUML Extension.

![ER диаграмма](/images/05_ER_diagram.png)
